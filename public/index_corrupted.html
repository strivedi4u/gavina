<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>ü§ñ Advanced RAG Chatbot - GPT-5 Enhanced</title>    <script src="https://cdn.tailwindcss.com"></script>    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.js"></script>    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">    <style>        .chat-message {            animation: slideIn 0.3s ease-out;        }        @keyframes slideIn {            from { opacity: 0; transform: translateY(20px); }            to { opacity: 1; transform: translateY(0); }        }        .processing {            animation: pulse 2s infinite;        }        .gradient-bg {            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);        }        .glass {            background: rgba(255, 255, 255, 0.1);            backdrop-filter: blur(10px);            border: 1px solid rgba(255, 255, 255, 0.2);        }        .tab-content {            display: none;        }        .tab-content.active {            display: block;        }        .progress-bar {            transition: width 0.3s ease;        }    </style></head><body class="bg-gray-900 text-white min-h-screen">    <!-- Header -->    <header class="gradient-bg shadow-lg">        <div class="container mx-auto px-4 py-6">            <div class="flex items-center justify-between">                <div class="flex items-center space-x-4">                    <div class="text-4xl">ü§ñ</div>                    <div>                        <h1 class="text-3xl font-bold">Advanced RAG Chatbot</h1>                        <p class="text-blue-200">GPT-5 Enhanced ‚Ä¢ Multimodal ‚Ä¢ Memory Enabled</p>                    </div>                </div>                <div class="flex items-center space-x-4">                    <div id="connectionStatus" class="flex items-center space-x-2">                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>                        <span class="text-sm">Connected</span>                    </div>                    <button id="settingsBtn" class="glass px-4 py-2 rounded-lg hover:bg-white/20 transition-all">                        <i class="fas fa-cog"></i> Settings                    </button>                </div>            </div>        </div>    </header>    <!-- Main Container -->    <div class="container mx-auto px-4 py-6">        <!-- Tab Navigation -->        <div class="flex space-x-2 mb-6 overflow-x-auto">            <button class="tab-btn active px-6 py-3 rounded-lg glass whitespace-nowrap" data-tab="chat">                <i class="fas fa-comments mr-2"></i>Chat            </button>            <button class="tab-btn px-6 py-3 rounded-lg glass whitespace-nowrap hover:bg-white/20" data-tab="upload">                <i class="fas fa-upload mr-2"></i>Upload Files            </button>            <button class="tab-btn px-6 py-3 rounded-lg glass whitespace-nowrap hover:bg-white/20" data-tab="visualize">                <i class="fas fa-chart-scatter mr-2"></i>Visualizations            </button>            <button class="tab-btn px-6 py-3 rounded-lg glass whitespace-nowrap hover:bg-white/20" data-tab="memory">                <i class="fas fa-brain mr-2"></i>Memory            </button>            <button class="tab-btn px-6 py-3 rounded-lg glass whitespace-nowrap hover:bg-white/20" data-tab="analytics">                <i class="fas fa-analytics mr-2"></i>Analytics            </button>            <button class="tab-btn px-6 py-3 rounded-lg glass whitespace-nowrap hover:bg-white/20" data-tab="vectors">                <i class="fas fa-database mr-2"></i>Vector DB            </button>        </div>        <!-- Chat Tab -->        <div id="chat" class="tab-content active">            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">                <!-- Chat Interface -->                <div class="lg:col-span-2">                    <div class="glass rounded-lg p-6 h-96 mb-4">                        <div id="chatMessages" class="h-full overflow-y-auto space-y-4 pr-2">                            <div class="chat-message">                                <div class="flex items-start space-x-3">                                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">                                        <i class="fas fa-robot text-sm"></i>                                    </div>                                    <div class="bg-gray-800 rounded-lg p-3 max-w-xs lg:max-w-md">                                        <p class="text-sm">Welcome! I'm your advanced RAG assistant with:</p>                                        <ul class="text-xs mt-2 space-y-1">                                            <li>üß† Persistent memory & learning</li>                                            <li>üëÅÔ∏è Vision analysis (images/videos)</li>                                            <li>üéµ Audio transcription</li>                                            <li>üìÑ Document processing (PDF, Word, Excel)</li>                                            <li>üåê Web scraping & URL analysis</li>                                            <li>üìä Vector visualizations</li>                                        </ul>                                        <p class="text-xs mt-2">How can I help you today?</p>                                    </div>                                </div>                            </div>                        </div>                    </div>                                        <!-- Input Area -->                    <div class="glass rounded-lg p-4">                        <div class="flex space-x-3">                            <input                                 id="messageInput"                                 type="text"                                 placeholder="Ask me anything... I have memory and can process any file type!"                                class="flex-1 bg-gray-800 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"                                onkeypress="handleKeyPress(event)"                            >                            <button                                 id="sendBtn"                                 onclick="sendMessage()"                                 class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg transition-all"                            >                                <i class="fas fa-paper-plane"></i>                            </button>                        </div>                                                <!-- Quick Actions -->                        <div class="mt-3 flex flex-wrap gap-2">                            <button onclick="quickAction('What can you do?')" class="text-xs bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded-full">                                What can you do?                            </button>                            <button onclick="quickAction('Show my conversation history')" class="text-xs bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded-full">                                My History                            </button>                            <button onclick="quickAction('Create a vector visualization')" class="text-xs bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded-full">                                Visualize Data                            </button>                            <button onclick="quickAction('What do you remember about me?')" class="text-xs bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded-full">                                My Memory                            </button>                        </div>                    </div>                </div>                <!-- Side Panel -->                <div class="space-y-4">                    <!-- Status -->                    <div class="glass rounded-lg p-4">                        <h3 class="font-semibold mb-3"><i class="fas fa-info-circle mr-2"></i>System Status</h3>                        <div id="systemStatus" class="space-y-2 text-sm">                            <div class="flex justify-between">                                <span>Vector DB:</span>                                <span id="vectorStatus" class="text-green-400">Loading...</span>                            </div>                            <div class="flex justify-between">                                <span>Memory:</span>                                <span id="memoryStatus" class="text-green-400">Active</span>                            </div>                            <div class="flex justify-between">                                <span>Vision:</span>                                <span id="visionStatus" class="text-green-400">Enabled</span>                            </div>                            <div class="flex justify-between">                                <span>Audio:</span>                                <span id="audioStatus" class="text-green-400">Enabled</span>                            </div>                        </div>                    </div>                    <!-- Memory Stats -->                    <div class="glass rounded-lg p-4">                        <h3 class="font-semibold mb-3"><i class="fas fa-brain mr-2"></i>Memory Stats</h3>                        <div id="memoryStats" class="space-y-2 text-sm">                            <div class="flex justify-between">                                <span>Conversations:</span>                                <span id="conversationCount">-</span>                            </div>                            <div class="flex justify-between">                                <span>Memories:</span>                                <span id="memoryCount">-</span>                            </div>                            <div class="flex justify-between">                                <span>Profile:</span>                                <span id="profileStatus">-</span>                            </div>                        </div>                    </div>                    <!-- Processing Status -->                    <div id="processingStatus" class="glass rounded-lg p-4 hidden">                        <h3 class="font-semibold mb-3"><i class="fas fa-cog fa-spin mr-2"></i>Processing</h3>                        <div id="processingInfo" class="text-sm">                            <div id="processingMessage" class="mb-2">Processing your request...</div>                            <div class="w-full bg-gray-700 rounded-full h-2">                                <div id="processingProgress" class="bg-blue-600 h-2 rounded-full progress-bar" style="width: 0%"></div>                            </div>                        </div>                    </div>                </div>            </div>        </div>        <!-- Upload Files Tab -->        <div id="upload" class="tab-content">            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">                <!-- File Upload -->                <div class="glass rounded-lg p-6">                    <h2 class="text-2xl font-bold mb-4"><i class="fas fa-cloud-upload-alt mr-2"></i>Upload Files</h2>                    <div id="dropZone" class="border-2 border-dashed border-gray-500 rounded-lg p-8 text-center hover:border-blue-500 transition-all cursor-pointer">                        <i class="fas fa-file-upload text-4xl mb-4 text-gray-400"></i>                        <p class="text-lg mb-2">Drop files here or click to upload</p>                        <p class="text-sm text-gray-400">Supports: PDF, Word, Excel, Images, Audio, Video, and more!</p>                        <input type="file" id="fileInput" multiple class="hidden" onchange="handleFiles(this.files)">                    </div>                                        <!-- URL Processing -->                    <div class="mt-6">                        <h3 class="font-semibold mb-3"><i class="fas fa-link mr-2"></i>Process URL</h3>                        <div class="flex space-x-3">                            <input                                 id="urlInput"                                 type="url"                                 placeholder="Enter URL to process..."                                class="flex-1 bg-gray-800 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"                            >                            <button onclick="processURL()" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg">                                <i class="fas fa-globe"></i>                            </button>                        </div>                    </div>                    <!-- Question for Processing -->                    <div class="mt-4">                        <label class="block text-sm font-medium mb-2">Question/Analysis Request:</label>                        <textarea                             id="analysisQuestion"                            placeholder="What would you like me to analyze about these files? (e.g., 'Summarize the main points', 'Extract key data', 'Find similarities')"                            class="w-full bg-gray-800 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 h-20 resize-none"                        ></textarea>                    </div>                </div>                <!-- Processing Results -->                <div class="glass rounded-lg p-6">                    <h2 class="text-2xl font-bold mb-4"><i class="fas fa-tasks mr-2"></i>Processing Results</h2>                    <div id="uploadResults" class="space-y-4">                        <div class="text-gray-400 text-center py-8">                            <i class="fas fa-hourglass-half text-3xl mb-3"></i>                            <p>Upload files or enter a URL to see processing results</p>                        </div>                    </div>                </div>            </div>        </div>        <!-- Visualizations Tab -->        <div id="visualize" class="tab-content">            <div class="glass rounded-lg p-6">                <h2 class="text-2xl font-bold mb-4"><i class="fas fa-chart-scatter mr-2"></i>Vector Visualizations</h2>                                <!-- Visualization Controls -->                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">                    <div>                        <label class="block text-sm font-medium mb-2">Visualization Type:</label>                        <select id="vizType" class="w-full bg-gray-800 rounded-lg px-3 py-2">                            <option value="scatter">Scatter Plot</option>                            <option value="cluster">Cluster Analysis</option>                            <option value="heatmap">Similarity Heatmap</option>                            <option value="network">Network Graph</option>                            <option value="timeline">Timeline View</option>                        </select>                    </div>                    <div>                        <label class="block text-sm font-medium mb-2">Dimensions:</label>                        <select id="vizDimensions" class="w-full bg-gray-800 rounded-lg px-3 py-2">                            <option value="2">2D</option>                            <option value="3">3D</option>                        </select>                    </div>                    <div>                        <label class="block text-sm font-medium mb-2">Color By:</label>                        <select id="vizColorBy" class="w-full bg-gray-800 rounded-lg px-3 py-2">                            <option value="category">Category</option>                            <option value="type">Type</option>                            <option value="timestamp">Time</option>                            <option value="importance">Importance</option>                        </select>                    </div>                    <div>                        <label class="block text-sm font-medium mb-2">Max Vectors:</label>                        <select id="vizMaxVectors" class="w-full bg-gray-800 rounded-lg px-3 py-2">                            <option value="100">100</option>                            <option value="500">500</option>                            <option value="1000">1000</option>                            <option value="2000">2000</option>                        </select>                    </div>                </div>                <button onclick="createVisualization()" class="bg-purple-600 hover:bg-purple-700 px-6 py-3 rounded-lg mb-6">                    <i class="fas fa-magic mr-2"></i>Create Visualization                </button>                <!-- Visualization Display -->                <div id="visualizationContainer" class="bg-gray-800 rounded-lg p-4 min-h-96">                    <div class="text-gray-400 text-center py-16">                        <i class="fas fa-chart-line text-5xl mb-4"></i>                        <p class="text-lg">Vector visualizations will appear here</p>                        <p class="text-sm">Create your first visualization to see your data relationships</p>                    </div>                </div>                <!-- Saved Visualizations -->                <div class="mt-6">                    <h3 class="text-lg font-semibold mb-3">Saved Visualizations</h3>                    <div id="savedVisualizations" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">                        <!-- Saved visualizations will be loaded here -->                    </div>                </div>            </div>        </div>        <!-- Memory Tab -->        <div id="memory" class="tab-content">            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">                <!-- Memory Management -->                <div class="glass rounded-lg p-6">                    <h2 class="text-2xl font-bold mb-4"><i class="fas fa-brain mr-2"></i>Memory Management</h2>                                        <!-- Store Memory -->                    <div class="mb-6">                        <h3 class="font-semibold mb-3">Store New Memory</h3>                        <div class="space-y-3">                            <input                                 id="memoryKey"                                 type="text"                                 placeholder="Memory key (e.g., 'preferred_style', 'important_fact')"                                class="w-full bg-gray-800 rounded-lg px-4 py-2"                            >                            <textarea                                 id="memoryValue"                                placeholder="Memory value or description..."                                class="w-full bg-gray-800 rounded-lg px-4 py-3 h-20 resize-none"                            ></textarea>                            <button onclick="storeMemory()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg">                                <i class="fas fa-save mr-2"></i>Store Memory                            </button>                        </div>                    </div>                    <!-- Search Memories -->                    <div>                        <h3 class="font-semibold mb-3">Search Memories</h3>                        <div class="flex space-x-3">                            <input                                 id="memorySearchQuery"                                 type="text"                                 placeholder="Search your memories..."                                class="flex-1 bg-gray-800 rounded-lg px-4 py-2"                            >                            <button onclick="searchMemories()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg">                                <i class="fas fa-search"></i>                            </button>                        </div>                    </div>                </div>                <!-- Memory Results -->                <div class="glass rounded-lg p-6">                    <h2 class="text-2xl font-bold mb-4"><i class="fas fa-history mr-2"></i>Memory & History</h2>                    <div id="memoryResults" class="space-y-4 max-h-96 overflow-y-auto">                        <!-- Memory results will appear here -->                    </div>                </div>            </div>            <!-- Conversation History -->            <div class="glass rounded-lg p-6 mt-6">                <h2 class="text-2xl font-bold mb-4"><i class="fas fa-comments mr-2"></i>Conversation History</h2>                <div id="conversationHistory" class="space-y-3 max-h-64 overflow-y-auto">                    <!-- Conversation history will be loaded here -->                </div>            </div>        </div>        <!-- Analytics Tab -->        <div id="analytics" class="tab-content">            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">                <!-- System Analytics -->                <div class="glass rounded-lg p-6">                    <h2 class="text-2xl font-bold mb-4"><i class="fas fa-chart-bar mr-2"></i>System Analytics</h2>                    <canvas id="analyticsChart" width="400" height="200"></canvas>                </div>                <!-- Performance Metrics -->                <div class="glass rounded-lg p-6">                    <h2 class="text-2xl font-bold mb-4"><i class="fas fa-tachometer-alt mr-2"></i>Performance</h2>                    <div id="performanceMetrics" class="space-y-4">                        <!-- Performance metrics will be loaded here -->                    </div>                </div>            </div>            <!-- Detailed Analytics -->            <div class="glass rounded-lg p-6 mt-6">                <h2 class="text-2xl font-bold mb-4"><i class="fas fa-analytics mr-2"></i>Detailed Analytics</h2>                <div id="detailedAnalytics" class="grid grid-cols-1 md:grid-cols-3 gap-6">                    <!-- Detailed analytics will be loaded here -->                </div>            </div>        </div>        <!-- Vector Database Tab -->        <div id="vectors" class="tab-content">            <div class="glass rounded-lg p-6">                <h2 class="text-2xl font-bold mb-4"><i class="fas fa-database mr-2"></i>Vector Database</h2>                                <!-- Vector Search -->                <div class="mb-6">                    <h3 class="font-semibold mb-3">Semantic Search</h3>                    <div class="flex space-x-3">                        <input                             id="vectorSearchQuery"                             type="text"                             placeholder="Search vectors semantically..."                            class="flex-1 bg-gray-800 rounded-lg px-4 py-3"                        >                        <button onclick="searchVectors()" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg">                            <i class="fas fa-search mr-2"></i>Search                        </button>                    </div>                </div>                <!-- Add Vector -->                <div class="mb-6">                    <h3 class="font-semibold mb-3">Add Vector</h3>                    <div class="space-y-3">                        <textarea                             id="vectorText"                            placeholder="Enter text to embed and store..."                            class="w-full bg-gray-800 rounded-lg px-4 py-3 h-20 resize-none"                        ></textarea>                        <button onclick="addVector()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg">                            <i class="fas fa-plus mr-2"></i>Add Vector                        </button>                    </div>                </div>                <!-- Vector Stats -->                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">                    <div class="bg-gray-800 rounded-lg p-4 text-center">                        <div class="text-2xl font-bold text-blue-400" id="totalVectors">-</div>                        <div class="text-sm text-gray-400">Total Vectors</div>                    </div>                    <div class="bg-gray-800 rounded-lg p-4 text-center">                        <div class="text-2xl font-bold text-green-400" id="vectorDimensions">-</div>                        <div class="text-sm text-gray-400">Dimensions</div>                    </div>                    <div class="bg-gray-800 rounded-lg p-4 text-center">                        <div class="text-2xl font-bold text-purple-400" id="indexFullness">-</div>                        <div class="text-sm text-gray-400">Index Fullness</div>                    </div>                </div>                <!-- Search Results -->                <div id="vectorSearchResults" class="space-y-3">                    <!-- Vector search results will appear here -->                </div>            </div>        </div>    </div>    <!-- Settings Modal -->    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">        <div class="glass rounded-lg p-6 max-w-md w-full mx-4">            <h2 class="text-xl font-bold mb-4">Settings</h2>            <div class="space-y-4">                <div>                    <label class="block text-sm font-medium mb-2">User ID:</label>                    <input id="userIdInput" type="text" value="default" class="w-full bg-gray-800 rounded-lg px-3 py-2">                </div>                <div>                    <label class="block text-sm font-medium mb-2">Response Style:</label>                    <select id="responseStyle" class="w-full bg-gray-800 rounded-lg px-3 py-2">                        <option value="comprehensive">Comprehensive</option>                        <option value="brief">Brief</option>                        <option value="technical">Technical</option>                        <option value="casual">Casual</option>                    </select>                </div>                <div class="flex items-center space-x-2">                    <input type="checkbox" id="enableMemory" checked>                    <label for="enableMemory">Enable Memory</label>                </div>                <div class="flex items-center space-x-2">                    <input type="checkbox" id="enableVision" checked>                    <label for="enableVision">Enable Vision Analysis</label>                </div>            </div>            <div class="flex justify-end space-x-3 mt-6">                <button onclick="closeSettings()" class="px-4 py-2 rounded-lg bg-gray-600 hover:bg-gray-700">                    Cancel                </button>                <button onclick="saveSettings()" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700">                    Save                </button>            </div>        </div>    </div>    <script>        // Global variables        let socket;        let currentUserId = 'default';        let isProcessing = false;        // Initialize the application        document.addEventListener('DOMContentLoaded', function() {            initializeApp();            setupEventListeners();            loadSystemStatus();            loadMemoryStats();            loadVectorStats();        });        function initializeApp() {            // Initialize Socket.IO            socket = io();                        socket.on('connect', () => {                console.log('Connected to server');                document.getElementById('connectionStatus').innerHTML = `                    <div class="w-3 h-3 bg-green-500 rounded-full"></div>                    <span class="text-sm">Connected</span>                `;                socket.emit('join_user_room', currentUserId);            });            socket.on('disconnect', () => {                document.getElementById('connectionStatus').innerHTML = `                    <div class="w-3 h-3 bg-red-500 rounded-full"></div>                    <span class="text-sm">Disconnected</span>                `;            });            socket.on('processing_started', (data) => {                showProcessingStatus(data.message);            });            socket.on('progress_update', (data) => {                updateProcessingProgress(data.progress, data.message);            });            socket.on('processing_completed', (data) => {                hideProcessingStatus();                if (data.success) {                    console.log('Processing completed successfully');                } else {                    console.error('Processing failed:', data.error);                }            });        }        function setupEventListeners() {            // Tab switching            document.querySelectorAll('.tab-btn').forEach(btn => {                btn.addEventListener('click', (e) => switchTab(e.target.dataset.tab));            });            // File drop zone            const dropZone = document.getElementById('dropZone');            dropZone.addEventListener('click', () => document.getElementById('fileInput').click());            dropZone.addEventListener('dragover', (e) => {                e.preventDefault();                dropZone.classList.add('border-blue-500');            });            dropZone.addEventListener('dragleave', () => {                dropZone.classList.remove('border-blue-500');            });            dropZone.addEventListener('drop', (e) => {                e.preventDefault();                dropZone.classList.remove('border-blue-500');                handleFiles(e.dataTransfer.files);            });            // Settings            document.getElementById('settingsBtn').addEventListener('click', openSettings);        }        function switchTab(tabName) {            // Hide all tab contents            document.querySelectorAll('.tab-content').forEach(content => {                content.classList.remove('active');            });                        // Remove active class from all tab buttons            document.querySelectorAll('.tab-btn').forEach(btn => {                btn.classList.remove('active', 'bg-white/20');            });                        // Show selected tab content            document.getElementById(tabName).classList.add('active');                        // Add active class to selected tab button            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active', 'bg-white/20');            // Load tab-specific data            if (tabName === 'memory') {                loadConversationHistory();            } else if (tabName === 'analytics') {                loadAnalytics();            } else if (tabName === 'visualize') {                loadSavedVisualizations();            }        }        function handleKeyPress(event) {            if (event.key === 'Enter' && !event.shiftKey) {                event.preventDefault();                sendMessage();            }        }        function quickAction(message) {            document.getElementById('messageInput').value = message;            sendMessage();        }        async function sendMessage() {            const input = document.getElementById('messageInput');            const message = input.value.trim();                        if (!message || isProcessing) return;            // Add user message to chat            addMessageToChat(message, 'user');            input.value = '';            isProcessing = true;            try {                const response = await fetch('/api/chat', {                    method: 'POST',                    headers: {                        'Content-Type': 'application/json',                        'X-User-ID': currentUserId                    },                    body: JSON.stringify({ message })                });                const data = await response.json();                                if (data.response) {                    addMessageToChat(data.response, 'bot');                    updateMemoryStats();                } else {                    throw new Error(data.error || 'Failed to get response');                }            } catch (error) {                console.error('Error sending message:', error);                addMessageToChat('Sorry, I encountered an error. Please try again.', 'bot', true);            } finally {                isProcessing = false;            }        }        function addMessageToChat(message, sender, isError = false) {            const chatMessages = document.getElementById('chatMessages');            const messageDiv = document.createElement('div');            messageDiv.className = 'chat-message';            const isUser = sender === 'user';            const bgColor = isError ? 'bg-red-600' : (isUser ? 'bg-blue-600' : 'bg-gray-800');            const iconClass = isUser ? 'fa-user' : 'fa-robot';            const alignment = isUser ? 'flex-row-reverse' : '';            messageDiv.innerHTML = `                <div class="flex items-start space-x-3 ${alignment}">                    <div class="w-8 h-8 ${bgColor} rounded-full flex items-center justify-center flex-shrink-0">                        <i class="fas ${iconClass} text-sm"></i>                    </div>                    <div class="${bgColor} rounded-lg p-3 max-w-xs lg:max-w-md">                        <div class="prose prose-invert text-sm">${marked.parse(message)}</div>                    </div>                </div>            `;            chatMessages.appendChild(messageDiv);            chatMessages.scrollTop = chatMessages.scrollHeight;        }        async function handleFiles(files) {            if (files.length === 0) return;            const formData = new FormData();            const question = document.getElementById('analysisQuestion').value || 'Analyze these files and provide a comprehensive summary.';                        Array.from(files).forEach(file => {                formData.append('files', file);            });            formData.append('question', question);            formData.append('userId', currentUserId);            showProcessingStatus('Processing uploaded files...');            try {                const response = await fetch('/api/upload', {                    method: 'POST',                    headers: {                        'X-User-ID': currentUserId                    },                    body: formData                });                const data = await response.json();                displayUploadResults(data);                updateMemoryStats();            } catch (error) {                console.error('Error uploading files:', error);                displayUploadResults({ error: 'Failed to process files' });            } finally {                hideProcessingStatus();            }        }        async function processURL() {            const urlInput = document.getElementById('urlInput');            const url = urlInput.value.trim();            const question = document.getElementById('analysisQuestion').value || 'Analyze this content and provide insights.';            if (!url) return;            showProcessingStatus('Processing URL...');            try {                const response = await fetch('/api/process-url', {                    method: 'POST',                    headers: {                        'Content-Type': 'application/json',                        'X-User-ID': currentUserId                    },                    body: JSON.stringify({ url, question })                });                const data = await response.json();                displayUploadResults(data);                urlInput.value = '';                updateMemoryStats();            } catch (error) {                console.error('Error processing URL:', error);                displayUploadResults({ error: 'Failed to process URL' });            } finally {                hideProcessingStatus();            }        }        function displayUploadResults(data) {            const resultsDiv = document.getElementById('uploadResults');                        if (data.error) {                resultsDiv.innerHTML = `                    <div class="bg-red-600 rounded-lg p-4">                        <h3 class="font-semibold mb-2">Error</h3>                        <p class="text-sm">${data.error}</p>                    </div>                `;                return;            }            resultsDiv.innerHTML = `                <div class="bg-green-600 rounded-lg p-4">                    <h3 class="font-semibold mb-2">Processing Completed</h3>                    <p class="text-sm mb-3">Files: ${data.filesProcessed || 0}, URLs: ${data.urlsProcessed || 0}</p>                    ${data.response ? `                        <div class="bg-gray-800 rounded p-3 mt-3">                            <h4 class="font-medium mb-2">Analysis:</h4>                            <div class="prose prose-invert text-sm">${marked.parse(data.response)}</div>                        </div>                    ` : ''}                </div>            `;        }        // Additional functions for visualization, memory, analytics, etc.        async function createVisualization() {            const type = document.getElementById('vizType').value;            const dimensions = parseInt(document.getElementById('vizDimensions').value);            const colorBy = document.getElementById('vizColorBy').value;            const maxVectors = parseInt(document.getElementById('vizMaxVectors').value);            showProcessingStatus('Creating visualization...');            try {                const response = await fetch('/api/visualize', {                    method: 'POST',                    headers: {                        'Content-Type': 'application/json',                        'X-User-ID': currentUserId                    },                    body: JSON.stringify({                        type,                        dimensions,                        colorBy,                        maxVectors,                        includeLabels: true                    })                });                const data = await response.json();                                if (data.visualization) {                    displayVisualization(data.visualization);                    loadSavedVisualizations();                } else {                    throw new Error(data.error || 'Failed to create visualization');                }            } catch (error) {                console.error('Error creating visualization:', error);                document.getElementById('visualizationContainer').innerHTML = `                    <div class="text-red-400 text-center py-16">                        <i class="fas fa-exclamation-triangle text-3xl mb-3"></i>                        <p>Failed to create visualization</p>                    </div>                `;            } finally {                hideProcessingStatus();            }        }        function displayVisualization(viz) {            const container = document.getElementById('visualizationContainer');            container.innerHTML = `                <div class="mb-4">                    <h3 class="font-semibold">${viz.type} Visualization</h3>                    <p class="text-sm text-gray-400">Vectors: ${viz.metadata.vectorCount}</p>                </div>                <iframe src="${viz.url}" class="w-full h-96 rounded border-0"></iframe>            `;        }        // Continue with all the helper functions...        async function loadSystemStatus() {            try {                const response = await fetch('/api/status');                const data = await response.json();                                document.getElementById('vectorStatus').textContent =                     data.services.vectorDatabase === 'connected' ? 'Connected' : 'Local';                document.getElementById('memoryStatus').textContent =                     data.services.memory === 'enabled' ? 'Enabled' : 'Disabled';                document.getElementById('visionStatus').textContent =                     data.services.vision === 'enabled' ? 'Enabled' : 'Disabled';                document.getElementById('audioStatus').textContent =                     data.services.audio === 'enabled' ? 'Enabled' : 'Disabled';            } catch (error) {                console.error('Error loading system status:', error);            }        }        async function loadMemoryStats() {            try {                const response = await fetch('/api/memory/stats', {                    headers: { 'X-User-ID': currentUserId }                });                                const data = await response.json();                                document.getElementById('conversationCount').textContent = data.stats.conversationCount || 0;                document.getElementById('memoryCount').textContent = data.stats.memoryCount || 0;                document.getElementById('profileStatus').textContent = data.stats.hasProfile ? 'Active' : 'None';            } catch (error) {                console.error('Error loading memory stats:', error);            }        }        async function updateMemoryStats() {            setTimeout(loadMemoryStats, 1000);        }        async function loadVectorStats() {            try {                const response = await fetch('/api/vector/stats');                const data = await response.json();                                document.getElementById('totalVectors').textContent = data.totalVectors || 0;                document.getElementById('vectorDimensions').textContent = data.dimension || 0;                document.getElementById('indexFullness').textContent =                     data.indexFullness ? (data.indexFullness * 100).toFixed(1) + '%' : '0%';            } catch (error) {                console.error('Error loading vector stats:', error);            }        }        function showProcessingStatus(message) {            const statusDiv = document.getElementById('processingStatus');            const messageDiv = document.getElementById('processingMessage');            messageDiv.textContent = message;            statusDiv.classList.remove('hidden');        }        function hideProcessingStatus() {            document.getElementById('processingStatus').classList.add('hidden');        }        function openSettings() {            document.getElementById('settingsModal').classList.remove('hidden');        }        function closeSettings() {            document.getElementById('settingsModal').classList.add('hidden');        }        function saveSettings() {            currentUserId = document.getElementById('userIdInput').value || 'default';            localStorage.setItem('ragUserId', currentUserId);            socket.emit('join_user_room', currentUserId);            closeSettings();            loadMemoryStats();        }        // Load saved settings        const savedUserId = localStorage.getItem('ragUserId');        if (savedUserId) {            currentUserId = savedUserId;            document.getElementById('userIdInput').value = savedUserId;        }    </script></body></html>